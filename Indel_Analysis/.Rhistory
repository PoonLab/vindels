edge.idx <- tre$edge[,1]==a  # FINDS THE EDGES (row #) corresponding with the parent node ; ap: select rows in edge matrix with parent node index
c(a,   # index of the parent node
which(edge.idx),
t(     # transpose so we can concatenate this vector to i
tre$edge[edge.idx, 2]    # column of tip indices
)
)
})
m
df <- data.frame(node.index=m[1,], edge1=m[2,], edge2=m[3,], tip1=m[4,], tip2=m[5,])
drf
df
tre
tfolder
i=7
tre <- read.tree(tfolder[i])
#for output
name <- strsplit(tfolder[i], "/")[[1]][7]
subtype <- strsplit(name, "_CR")[[1]][1]
filename <- paste0(subtype,"+.csv" )
#naming the csv
#names(csv) <- c('accno', 'VR1', 'VR2','VR3', 'VR4', 'VR5')
#counting tips
n <- Ntip(tre)
# number of tips per internal node
# count the number of instances that first column (node) corresponds to a second column number which is <= n (meaning it is a tip)
numtips <- tabulate(tre$edge[,1][tre$edge[,2] <= n])
#determines which nodes contain cherries (returns vector with their integer positions)
is.cherry <- sapply(numtips, function(d) d==2)
# construct data frame where each row corresponds to a cherry
m <- sapply(which(is.cherry), function(a) { #will input the numbers of nodes containing 2 tips?
edge.idx <- tre$edge[,1]==a  # FINDS THE EDGES (row #) corresponding with the parent node ; ap: select rows in edge matrix with parent node index
c(a,   # index of the parent node
which(edge.idx),
t(     # transpose so we can concatenate this vector to i
tre$edge[edge.idx, 2]    # column of tip indices
)
)
})
df <- data.frame(node.index=m[1,], edge1=m[2,], edge2=m[3,], tip1=m[4,], tip2=m[5,])
name <- strsplit(tfolder[i], "/")[[1]][7]
subtype <- strsplit(name, "_CR")[[1]][1]
filename <- paste0(subtype,"+.csv" )
tre <- multi2di(tre)
#naming the csv
#names(csv) <- c('accno', 'VR1', 'VR2','VR3', 'VR4', 'VR5')
#counting tips
n <- Ntip(tre)
# number of tips per internal node
# count the number of instances that first column (node) corresponds to a second column number which is <= n (meaning it is a tip)
numtips <- tabulate(tre$edge[,1][tre$edge[,2] <= n])
#determines which nodes contain cherries (returns vector with their integer positions)
is.cherry <- sapply(numtips, function(d) d==2)
# construct data frame where each row corresponds to a cherry
m <- sapply(which(is.cherry), function(a) { #will input the numbers of nodes containing 2 tips?
edge.idx <- tre$edge[,1]==a  # FINDS THE EDGES (row #) corresponding with the parent node ; ap: select rows in edge matrix with parent node index
c(a,   # index of the parent node
which(edge.idx),
t(     # transpose so we can concatenate this vector to i
tre$edge[edge.idx, 2]    # column of tip indices
)
)
})
df <- data.frame(node.index=m[1,], edge1=m[2,], edge2=m[3,], tip1=m[4,], tip2=m[5,])
df$tip1.label <- tre$tip.label[df$tip1]
df$tip2.label <- tre$tip.label[df$tip2]
df$tip1.len <- tre$edge.length[df$edge1]
df$tip2.len <- tre$edge.length[df$edge2]
df
setwd("~/vindels/Indel_Analysis/")
require(bbmle)
require(MASS)
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
pll <- function(rate, outcomes, times) {
# @param rate:  instantaneous rate of indels
# @param outcomes:  vector of boolean values, TRUE if *no* indel on cherry
# @param times:  vector of branch lengths associated with cherries
# @return: log-likelihood of model
pr <- exp(-rate * times)  # probabilities of no indels for each cherry
sum( outcomes * log(pr), (1-outcomes) * log(1-pr) )
}
csvfolder <- list.files(path="~/PycharmProjects/hiv-evolution-master/9_2_indels",full.names=TRUE)
max.llh <- data.frame(stringsAsFactors = FALSE)
max.llh2 <- data.frame(subtype=character(),stringsAsFactors = FALSE)
con.int <- data.frame(stringsAsFactors = FALSE)
big.df <- data.frame(stringsAsFactors = FALSE)
rates <- c()
for (i in 1:length(csvfolder)){
csv <- read.csv(csvfolder[i])
filename <- strsplit(strsplit(csvfolder[i], "/")[[1]][7], "\\.")[[1]][1]
max.llh2 [i,1] <- filename
print(filename)
times.df <- c()
outcomes.df <- data.frame()
for (z in 1:5){
times <- csv$total.length[which(!is.na(csv[paste0("VR",z,".indel")]))]
times.df <- c(times.df, times)
outcomes <- csv[which(!is.na(csv[paste0("VR",z,".indel")])),paste0("VR",z,".indel")]
outcomes.df <- rbind(outcomes.df, data.frame(out=outcomes, vregion=z))
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
mle.result <- bbmle::mle2(obj.f, start=list(rate=1), method = "Brent", lower=1e-12, upper = 1)
max.llh <- rbind(max.llh, data.frame(subtype=filename, vloop=z, rate=coef(mle.result)[[1]]))
max.llh2 [i,z+1] <- coef(mle.result)[[1]]
rates <- c(rates,coef(mle.result)[[1]]) # this is the rate
#res$value #this is the likelihood
if(!all(outcomes)){
int <- confint(mle.result, level = 0.95)
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=int[[1]],upper=int[[2]]))
}else{
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=0,upper=0))
}
}
big.df <- rbind(big.df, data.frame(subtype=rep(filename, length(times.df)), Time=times.df, outcomes=outcomes.df$out, Vregion=as.factor(outcomes.df$vregion)))
}
fit <- glm(!outcomes ~ subtype + Vregion + Time, family= "binomial", data=big.df)
fit2 <- glm(!outcomes ~ subtype * Vregion + Time, family= "binomial", data=big.df)
fit.aic <- stepAIC(fit, scope=list(upper=fit2, lower=~1), direction='both', trace=TRUE)
summary(fit.aic)
write.csv(max.llh, "indel_rates2.csv")
write.csv(con.int, "conf_ints2.csv")
max.llh
require(ggplot2)
require(RColorBrewer)
colors <- brewer.pal(5, 'Set1')
}
rates <- split(max.llh[,2:3], max.llh[,1])
rates
ggplot(rates) + geom_bar(aes(x=vloop, y=rate), position=position_dodge(width=10), show.legend=T) + geom_errorbar(limits, width = 0.25)
typeof(rate)
typeof(rates)
as.data.frame(rates)
as.matrix(rates)
as.array(rates)
ggplot(max.llh) + geom_bar(aes(x=vloop, y=rate), position=position_dodge(width=10), show.legend=T) + geom_errorbar(limits, width = 0.25)
ggplot(max.llh) + geom_bar(aes(x=vloop, y=rate), position=position_dodge(width=10), show.legend=T) #+ geom_errorbar(limits, width = 0.25)
ggplot(max.llh) + geom_bar(stat="identity",aes(x=vloop, y=rate), position=position_dodge(width=10), show.legend=T) #+ geom_errorbar(limits, width = 0.25)
max.llh
ggplot(max.llh) + geom_bar(stat="identity",aes(x=vloop, y=rate), position=position_dodge(width=10), show.legend=T) +facet_wrap(~vloop)
ggplot(max.llh) + geom_bar(stat="identity",aes(x=subtype, y=rate), position=position_dodge(width=10), show.legend=T) +facet_wrap(~vloop)
ggplot(max.llh) + geom_bar(stat="identity",aes(x=subtype, y=rate), position=position_dodge(width=10), show.legend=T)
+facet_wrap(~vloop)
+ geom_errorbar(limits, width = 0.25)
ggplot(max.llh) + geom_bar(stat="identity",aes(x=subtype, y=rate, colour=subtype), position=position_dodge(width=10), show.legend=T) +facet_wrap(~vloop) + geom_errorbar(limits, width = 0.25)
ggplot(max.llh) + geom_bar(stat="identity",aes(x=subtype, y=rate, colour=subtype), position=position_dodge(width=10), show.legend=T) +facet_wrap(~vloop)
ggplot(max.llh,aes(x=subtype, y=rate, colour=subtype)) + geom_bar(stat="identity", position=position_dodge(width=10), show.legend=T) +facet_wrap(~vloop) + #geom_errorbar(limits, width = 0.25)
geom_errorbar(limits, position = position_dodge(0.9),
width = 0.25)
ggplot(max.llh,aes(x=subtype, y=rate, colour=subtype)) + geom_bar(stat="identity", position=position_dodge(width=10), show.legend=T) +facet_wrap(~vloop)#  + #geom_errorbar(limits, width = 0.25)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype))
+ geom_bar(stat="identity", position=position_dodge(width=10), show.legend=T)
+ facet_wrap(~vloop)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(stat="identity", position=position_dodge(width=10), show.legend=T) + facet_wrap(~vloop)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=10), show.legend=T) + facet_wrap(~vloop)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=10), show.legend=T) + facet_wrap(~vloop) + theme_light())
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=10), show.legend=T) + facet_wrap(~vloop) + theme_light()
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=20), show.legend=T) + facet_wrap(~vloop) + theme_light()
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=0.5), show.legend=T) + facet_wrap(~vloop) + theme_light()
for (i in 1:length(csvfolder)){
csv <- read.csv(csvfolder[i])
filename <- strsplit(strsplit(csvfolder[i], "/")[[1]][7], "\\+.")[[1]][1]
max.llh2 [i,1] <- filename
print(filename)
times.df <- c()
outcomes.df <- data.frame()
for (z in 1:5){
times <- csv$total.length[which(!is.na(csv[paste0("VR",z,".indel")]))]
times.df <- c(times.df, times)
outcomes <- csv[which(!is.na(csv[paste0("VR",z,".indel")])),paste0("VR",z,".indel")]
outcomes.df <- rbind(outcomes.df, data.frame(out=outcomes, vregion=z))
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
mle.result <- bbmle::mle2(obj.f, start=list(rate=1), method = "Brent", lower=1e-12, upper = 1)
max.llh <- rbind(max.llh, data.frame(subtype=filename, vloop=z, rate=coef(mle.result)[[1]]))
max.llh2 [i,z+1] <- coef(mle.result)[[1]]
rates <- c(rates,coef(mle.result)[[1]]) # this is the rate
#res$value #this is the likelihood
if(!all(outcomes)){
int <- confint(mle.result, level = 0.95)
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=int[[1]],upper=int[[2]]))
}else{
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=0,upper=0))
}
}
big.df <- rbind(big.df, data.frame(subtype=rep(filename, length(times.df)), Time=times.df, outcomes=outcomes.df$out, Vregion=as.factor(outcomes.df$vregion)))
}
fit <- glm(!outcomes ~ subtype + Vregion + Time, family= "binomial", data=big.df)
fit2 <- glm(!outcomes ~ subtype * Vregion + Time, family= "binomial", data=big.df)
fit.aic <- stepAIC(fit, scope=list(upper=fit2, lower=~1), direction='both', trace=TRUE)
summary(fit.aic)
write.csv(max.llh, "indel_rates2.csv")
write.csv(con.int, "conf_ints2.csv")
con.inty
con.int
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=0.5), show.legend=T) + facet_wrap(~vloop) + theme_light() + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=0.5), show.legend=T) + facet_wrap(~vloop) + theme_light() + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 1)
max.llh
con.int
max.llh[,4:5] <- con.int[,3:4]
max.llh
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position=position_dodge(width=0.5), show.legend=T) + theme_light() + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + theme_light() + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_light() + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
plot <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_light()
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
c(rep(1,7),rep(2,7),rep(3,7),rep(4,7),rep(5,7))
order <- c(rep(1,7),rep(2,7),rep(3,7),rep(4,7),rep(5,7))
setwd("~/vindels/Indel_Analysis/")
require(bbmle)
require(MASS)
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
pll <- function(rate, outcomes, times) {
# @param rate:  instantaneous rate of indels
# @param outcomes:  vector of boolean values, TRUE if *no* indel on cherry
# @param times:  vector of branch lengths associated with cherries
# @return: log-likelihood of model
pr <- exp(-rate * times)  # probabilities of no indels for each cherry
sum( outcomes * log(pr), (1-outcomes) * log(1-pr) )
}
csvfolder <- list.files(path="~/PycharmProjects/hiv-evolution-master/9_2_indels",full.names=TRUE)
max.llh <- data.frame(stringsAsFactors = FALSE)
max.llh2 <- data.frame(subtype=character(),stringsAsFactors = FALSE)
con.int <- data.frame(stringsAsFactors = FALSE)
big.df <- data.frame(stringsAsFactors = FALSE)
rates <- c()
for (i in 1:length(csvfolder)){
csv <- read.csv(csvfolder[i])
filename <- strsplit(strsplit(csvfolder[i], "/")[[1]][7], "\\+.")[[1]][1]
max.llh2 [i,1] <- filename
print(filename)
times.df <- c()
outcomes.df <- data.frame()
for (z in 1:5){
times <- csv$total.length[which(!is.na(csv[paste0("VR",z,".indel")]))]
times.df <- c(times.df, times)
outcomes <- csv[which(!is.na(csv[paste0("VR",z,".indel")])),paste0("VR",z,".indel")]
outcomes.df <- rbind(outcomes.df, data.frame(out=outcomes, vregion=z))
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
mle.result <- bbmle::mle2(obj.f, start=list(rate=1), method = "Brent", lower=1e-12, upper = 1)
max.llh <- rbind(max.llh, data.frame(subtype=filename, vloop=z, rate=coef(mle.result)[[1]]))
max.llh2 [i,z+1] <- coef(mle.result)[[1]]
rates <- c(rates,coef(mle.result)[[1]]) # this is the rate
#res$value #this is the likelihood
if(!all(outcomes)){
int <- confint(mle.result, level = 0.95)
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=int[[1]],upper=int[[2]]))
}else{
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=0,upper=0))
}
}
big.df <- rbind(big.df, data.frame(subtype=rep(filename, length(times.df)), Time=times.df, outcomes=outcomes.df$out, Vregion=as.factor(outcomes.df$vregion)))
}
plot <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_bw()
plot +  geom_errorbar(limits, position = position_dodge(0.9),width = 0.25)
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
num
order
match(con.int,order)
match(con.int$vloop,order)
con.int[match(con.int$vloop,order)]
con.int[match(con.int$vloop,order),]
con.int <-con.int[match(con.int$vloop,order),]
plot <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_bw()
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
setwd("~/vindels/Indel_Analysis/")
require(bbmle)
require(MASS)
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
pll <- function(rate, outcomes, times) {
# @param rate:  instantaneous rate of indels
# @param outcomes:  vector of boolean values, TRUE if *no* indel on cherry
# @param times:  vector of branch lengths associated with cherries
# @return: log-likelihood of model
pr <- exp(-rate * times)  # probabilities of no indels for each cherry
sum( outcomes * log(pr), (1-outcomes) * log(1-pr) )
}
csvfolder <- list.files(path="~/PycharmProjects/hiv-evolution-master/9_2_indels",full.names=TRUE)
max.llh <- data.frame(stringsAsFactors = FALSE)
max.llh2 <- data.frame(subtype=character(),stringsAsFactors = FALSE)
con.int <- data.frame(stringsAsFactors = FALSE)
big.df <- data.frame(stringsAsFactors = FALSE)
rates <- c()
for (i in 1:length(csvfolder)){
csv <- read.csv(csvfolder[i])
filename <- strsplit(strsplit(csvfolder[i], "/")[[1]][7], "\\+.")[[1]][1]
max.llh2 [i,1] <- filename
print(filename)
times.df <- c()
outcomes.df <- data.frame()
for (z in 1:5){
times <- csv$total.length[which(!is.na(csv[paste0("VR",z,".indel")]))]
times.df <- c(times.df, times)
outcomes <- csv[which(!is.na(csv[paste0("VR",z,".indel")])),paste0("VR",z,".indel")]
outcomes.df <- rbind(outcomes.df, data.frame(out=outcomes, vregion=z))
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
mle.result <- bbmle::mle2(obj.f, start=list(rate=1), method = "Brent", lower=1e-12, upper = 1)
max.llh <- rbind(max.llh, data.frame(subtype=filename, vloop=z, rate=coef(mle.result)[[1]]))
max.llh2 [i,z+1] <- coef(mle.result)[[1]]
rates <- c(rates,coef(mle.result)[[1]]) # this is the rate
#res$value #this is the likelihood
if(!all(outcomes)){
int <- confint(mle.result, level = 0.95)
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=int[[1]],upper=int[[2]]))
}else{
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=0,upper=0))
}
}
big.df <- rbind(big.df, data.frame(subtype=rep(filename, length(times.df)), Time=times.df, outcomes=outcomes.df$out, Vregion=as.factor(outcomes.df$vregion)))
}
con.int
?order
order(con.int$vloop)
con.int[order(con.int$vloop),]
con.int <- con.int[order(con.int$vloop),]
con.int
plot <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_bw()
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + facet_wrap(~vloop)
install.packages("gridExtra")
require(gridExtra)
grid.arrange(plot, widths=c(1,1,1,1,1,1), layout_matrix=rbind(c(1,1,2,2,3,3),c(NA,4,4,5,5,NA)))
plot1 <- ggplot(max.llh[which(max.llh$subtype=="01_AE"])], aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + theme_bw()
plot1 <- ggplot(max.llh[which(max.llh$subtype=="01_AE"),], aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + theme_bw()
plot1
plot1 <- ggplot(max.llh], aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + theme_bw()
plot1 <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + theme_bw()
plot1
plot1 <- ggplot(max.llh[which(max.llh])], aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_bw()
plot1 <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop) + theme_bw()
plot1
ggplotGrob(plot1)
grid.draw(ggplotGrob(plot1))
grid.arrange(plot, widths=c(1,1,1), layout_matrix=rbind(c(1,2,3),c(NA,4,5)))
grid.arrange(grobs=ggplotGrob(plot1), widths=c(1,1,1), layout_matrix=rbind(c(1,2,3),c(NA,4,5)))
plot1
ggplotGrob(plot1)
plot1$layers
plot1$data
plot1 <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop,drop=F) + theme_bw()
plot1
plot1 <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop,ncol=c(3,2),nrow=2) + theme_bw()
plot1 <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop,ncol=3,nrow=2) + theme_bw()
plot1
plot1 <- ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop,ncol=2,nrow=3) + theme_bw()
plot1
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop,ncol=2,nrow=3) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=subtype, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~vloop,ncol=5,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~subtype,ncol=5,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~subtype,ncol=3,nrow=3) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
setwd("~/vindels/Indel_Analysis/")
require(bbmle)
require(MASS)
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
pll <- function(rate, outcomes, times) {
# @param rate:  instantaneous rate of indels
# @param outcomes:  vector of boolean values, TRUE if *no* indel on cherry
# @param times:  vector of branch lengths associated with cherries
# @return: log-likelihood of model
pr <- exp(-rate * times)  # probabilities of no indels for each cherry
sum( outcomes * log(pr), (1-outcomes) * log(1-pr) )
}
csvfolder <- list.files(path="~/PycharmProjects/hiv-evolution-master/9_2_indels",full.names=TRUE)
max.llh <- data.frame(stringsAsFactors = FALSE)
max.llh2 <- data.frame(subtype=character(),stringsAsFactors = FALSE)
con.int <- data.frame(stringsAsFactors = FALSE)
big.df <- data.frame(stringsAsFactors = FALSE)
rates <- c()
for (i in 1:length(csvfolder)){
csv <- read.csv(csvfolder[i])
filename <- strsplit(strsplit(csvfolder[i], "/")[[1]][7], "\\+.")[[1]][1]
max.llh2 [i,1] <- filename
print(filename)
times.df <- c()
outcomes.df <- data.frame()
for (z in 1:5){
times <- csv$total.length[which(!is.na(csv[paste0("VR",z,".indel")]))]
times.df <- c(times.df, times)
outcomes <- csv[which(!is.na(csv[paste0("VR",z,".indel")])),paste0("VR",z,".indel")]
outcomes.df <- rbind(outcomes.df, data.frame(out=outcomes, vregion=z))
obj.f <- function(rate) -pll(rate, outcomes, times)  # objective function
mle.result <- bbmle::mle2(obj.f, start=list(rate=1), method = "Brent", lower=1e-12, upper = 1)
max.llh <- rbind(max.llh, data.frame(subtype=filename, vloop=z, rate=coef(mle.result)[[1]]))
max.llh2 [i,z+1] <- coef(mle.result)[[1]]
rates <- c(rates,coef(mle.result)[[1]]) # this is the rate
#res$value #this is the likelihood
if(!all(outcomes)){
int <- confint(mle.result, level = 0.95)
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=int[[1]],upper=int[[2]]))
}else{
con.int <- rbind(con.int,data.frame(subtype=filename,vloop=z,lower=0,upper=0))
}
}
big.df <- rbind(big.df, data.frame(subtype=rep(filename, length(times.df)), Time=times.df, outcomes=outcomes.df$out, Vregion=as.factor(outcomes.df$vregion)))
}
con.int
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~subtype,ncol=3,nrow=3) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
grid.arrange(grobs=ggplotGrob(plot1), widths=c(1,1,1), layout_matrix=rbind(c(1,2,3),c(NA,4,5)))
grid.arrange(grobs=plot1, widths=c(1,1,1), layout_matrix=rbind(c(1,2,3),c(NA,4,5)))
grid.arrange(grobs=ggplotGrob(plot1), widths=c(1,1,1), layout_matrix=rbind(c(1,2,3),c(NA,4,5)))
ggplotGrob(plot1)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=T) + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype))
plot + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F)
plot + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype))
plot + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F)
plot + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
colors <- brewer.pal(7, 'Set1')
colors
ggplot(max.llh, aes(x=vloop, y=rate, fill=colors)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + xlab()
ggplot(max.llh, aes(x=vloop, y=rate, fill=colors)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
max.llh
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme_bw()+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.background = element_blank(), panel.grid.minor = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.minor = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.minor = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), panel.grid.minor.x = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank())+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim=(0,0.16)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.16)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0.1,0.16)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(expand=c(0,0) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
plot +  geom_errorbar(limits, position = position_dodge(0.9),width = 0.25)
pos = c(1:42)
axis(1,at=c(3.5,9.5,15.5,21.5,27.5,33.5,39.5), lab=c("AE","AG","A1","B","C","D","F1"),line=1,tick=F,cex.axis=1.3)
barplot(max.llh$rate, col=rep(colors,7), space=rep(c(1,0,0,0,0),7), ylim=c(0,0.08),xaxt='n')
rect(7,0.00,8,0.02,col=rgb(211/255,211/255,211/255))
text(7.5,0.002,adj=0,labels="NO ESTIMATE GIVEN",cex=1,srt=90)
rect(39,0.00,40,0.02,col=rgb(211/255,211/255,211/255))
text(39.5,0.002,adj=0,labels="NO ESTIMATE GIVEN",cex=1,srt=90)
axis(1,at=c(3.5,9.5,15.5,21.5,27.5,33.5,39.5),lab=c("AE","AG","A1","B","C","D","F1"), line=2, tick=F)
axis(1,at=pos2+0.5, lab=rep(c("1","2","3","4","5"),7),line=-1,tick=F,cex.axis=1)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(expand=c(0,0)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop, y=rate, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh) + geom_bar(aes(x=vloop, y=rate, fill=subtype)colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh) + geom_bar(aes(x=vloop, y=rate, fill=subtype),colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop,  fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(y=rate, limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop,  fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(rate, limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop,  fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop, y=rates fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous(limits=c(0,0.16)) + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1) + scale_y_continuous("HELLO THERE") + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + scale_y_continuous("HELLO THERE") + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25) + ylim(0,0.19)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), panel.grid.minor=element_line(size = 0.5, colour = "black"),axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ ggtitle("")+theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ ggtitle("HELLO THERE")+theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + xlab("Variable Loop") + ylab("Indel Rate (Events/Year)")+ labs(x="SUBTYPE")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + + labs(x="Variable Loop" + y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")
plot + theme(panel.grid.major = element_blank(),strip.text.x =, axis.line = element_line(colour = "black"))
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
#plot <- ggplot(data=max.llh)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")
plot + theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))
plot + geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+ theme(panel.grid.major = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=2)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=0.5)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1.1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=0.95)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=0.97)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=0.97)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x="HELLO", axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x="HELLO", axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x=element_text("HELLO"), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x.top =element_text("HELLO"), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x.top =element_text("HELLO"), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
?element_text
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x =element_text("HELLO",size=12), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot +  geom_errorbar(limits, position = position_dodge(0.9),width = 0.25)
install.packages("cowplot")
require(cowplot)
plot_grid(plot)
plot_grid(plot, labels="AUTO")
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.title.x =element_text("HELLO",size=12), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
plot <- ggplot(max.llh, aes(x=vloop, y=rates, fill=subtype, width=1)) + geom_bar(colour="black",stat="identity", position="dodge", show.legend=F) + facet_wrap(~subtype,ncol=7,nrow=1)
plot + labs(x="Variable Loop", y="Indel Rate (Events/Year)")+theme(panel.grid.major = element_blank(),strip.text.x = element_blank(), axis.line = element_line(colour = "black"))+ geom_errorbar(aes(ymax = con.int$upper, ymin = con.int$lower), width = 0.25)
